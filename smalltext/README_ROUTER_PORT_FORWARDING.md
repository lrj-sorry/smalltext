# SmallText 网站 - 路由器端口映射指南

## 什么是端口映射？

端口映射（也称为虚拟服务器）是一种将公网IP地址的端口映射到内网IP地址的特定端口的技术。通过端口映射，您可以让外部网络（不同WiFi）的设备访问您内网中的服务。

## 为什么需要端口映射？

当您在本地运行 SmallText 网站时，它只能在同一局域网内访问。要让不同WiFi下的手机访问，您需要：
1. 获取一个公网 IP 地址
2. 在路由器上配置端口映射，将公网端口映射到您电脑的内网IP和端口

## 步骤 1：获取您的公网 IP 地址

1. 打开浏览器，访问 [ip138.com](http://www.ip138.com/) 或 [whatismyip.com](https://www.whatismyip.com/)
2. 记录显示的公网 IP 地址（例如：123.45.67.89）

## 步骤 2：获取您电脑的局域网 IP 地址

### Windows 系统

1. 按下 `Win + R` 组合键，打开 "运行" 对话框
2. 输入 `cmd`，点击 "确定" 打开命令提示符
3. 在命令提示符中输入 `ipconfig`，按 Enter 键
4. 找到 "无线局域网适配器 WLAN" 或 "以太网适配器 以太网" 部分
5. 记录 "IPv4 地址"（例如：192.168.1.100）

### macOS 系统

1. 点击屏幕左上角的苹果图标，选择 "系统偏好设置"
2. 点击 "网络"
3. 选择您当前连接的网络，点击 "高级"
4. 切换到 "TCP/IP" 标签页
5. 记录 "IPv4 地址"（例如：192.168.1.100）

### Linux 系统

1. 打开终端
2. 输入 `ifconfig` 或 `ip addr`，按 Enter 键
3. 找到您当前连接的网络接口（例如：wlan0 或 eth0）
4. 记录 "inet" 地址（例如：192.168.1.100）

## 步骤 3：登录路由器管理界面

1. 打开浏览器
2. 在地址栏中输入路由器的默认网关地址（通常为 192.168.1.1、192.168.0.1 或 192.168.1.0）
3. 输入路由器的用户名和密码（通常可以在路由器背面找到）

## 步骤 4：配置端口映射

不同品牌的路由器界面可能略有不同，但配置步骤基本相似。以下是常见路由器品牌的配置方法：

### 华为路由器

1. 登录路由器管理界面
2. 点击 "高级设置" → "NAT" → "虚拟服务器"
3. 点击 "添加"
4. 填写以下信息：
   - 服务名称：SmallText
   - 外部端口：8000
   - 内部 IP 地址：您电脑的局域网 IP（例如：192.168.1.100）
   - 内部端口：8000
   - 协议：TCP
5. 点击 "保存"

### 小米路由器

1. 登录路由器管理界面
2. 点击 "高级设置" → "端口转发"
3. 点击 "添加规则"
4. 填写以下信息：
   - 服务名称：SmallText
   - 内部 IP：您电脑的局域网 IP（例如：192.168.1.100）
   - 内部端口：8000
   - 外部端口：8000
   - 协议：TCP
5. 点击 "保存"

### TP-Link 路由器

1. 登录路由器管理界面
2. 点击 "转发规则" → "虚拟服务器"
3. 点击 "添加新条目"
4. 填写以下信息：
   - 服务端口号：8000
   - IP 地址：您电脑的局域网 IP（例如：192.168.1.100）
   - 内部端口号：8000
   - 协议：TCP
   - 状态：启用
5. 点击 "保存"

### 华硕路由器

1. 登录路由器管理界面
2. 点击 "外部网络" → "端口转发"
3. 点击 "添加配置文件"
4. 填写以下信息：
   - 服务名称：SmallText
   - 端口范围：8000
   - 本地 IP 地址：您电脑的局域网 IP（例如：192.168.1.100）
   - 本地端口：8000
   - 协议：TCP
5. 点击 "应用本页面设置"

## 步骤 5：测试端口映射

1. 确保您的本地 SmallText HTTP 服务器正在运行：
   ```bash
   python -m http.server 8000 --bind 0.0.0.0
   ```

2. 打开浏览器，输入 `http://您的公网IP:8000`（例如：http://123.45.67.89:8000）
3. 如果能正常访问 SmallText 网站，说明端口映射配置成功

## 步骤 6：在不同 WiFi 下的手机上访问

1. 确保手机连接到不同的 WiFi 网络（非您电脑所在的 WiFi）
2. 打开手机浏览器
3. 输入 `http://您的公网IP:8000`（例如：http://123.45.67.89:8000）
4. 您应该能看到 SmallText 网站的登录页面

## 常见问题

### Q: 无法访问网站怎么办？

A: 检查以下几点：
1. 本地 HTTP 服务器是否正在运行
2. 路由器端口映射配置是否正确
3. 防火墙是否开放了 8000 端口
4. 公网 IP 是否为动态 IP（可能会变化）
5. 您的网络运营商是否封锁了 8000 端口（可以尝试使用其他端口，如 8080）

### Q: 公网 IP 会变化吗？

A: 大多数家庭宽带的公网 IP 是动态的，会定期变化。如果您需要固定的公网 IP，可以联系您的网络运营商申请静态 IP。

### Q: 如何检查防火墙设置？

A: 
- **Windows**: 打开 "控制面板" → "系统和安全" → "Windows Defender 防火墙" → "允许应用或功能通过 Windows Defender 防火墙" → 确保 "Python" 或 "HTTP 服务器" 已被允许
- **macOS**: 打开 "系统偏好设置" → "安全性与隐私" → "防火墙" → "防火墙选项" → 确保 Python 已被允许
- **Linux**: 使用 `sudo ufw status` 命令查看防火墙状态，并使用 `sudo ufw allow 8000/tcp` 命令开放 8000 端口

### Q: 可以使用其他端口吗？

A: 是的，您可以使用其他端口，如 8080、8888 等。只需在路由器端口映射中设置相同的外部端口和内部端口即可。

## 安全注意事项

1. **使用强密码**: 确保您的 SmallText 网站使用强密码，防止未授权访问
2. **定期更新**: 定期更新您的路由器固件，修复安全漏洞
3. **限制访问**: 考虑只允许特定 IP 地址访问您的网站
4. **使用 HTTPS**: 考虑为您的网站配置 HTTPS，加密传输数据
5. **关闭不必要的服务**: 只开放必要的端口，关闭不必要的服务

## 替代方案

如果您觉得配置路由器端口映射太复杂，可以尝试使用以下内网穿透工具：

1. **Cloudflare Tunnel**: 免费、稳定、安全，推荐使用
2. **ngrok**: 简单易用，但免费版有访问次数限制
3. **花生壳**: 商业软件，有免费版本，适合新手
4. **FRP**: 开源免费，适合有一定技术基础的用户

详细使用方法请参考 `README_PUBLIC_ACCESS.md` 和 `README_FRP.md` 文件。

## 测试账号

- **管理员账号**: admin / admin123
- **普通用户账号**: user1 / user1123

## 联系信息

如果您在配置过程中遇到问题，可以参考以下资源：
- [路由器品牌官方网站](https://www.google.com/)
- [端口映射教程](https://www.baidu.com/s?wd=路由器端口映射教程)
- [网络技术论坛](https://www.zhihu.com/topic/20030718/hot)
